version: '3.8'

services:

  microb-api-gateway:
    container_name: microb-api-gateway
    image: microb-apigateway:1.0.0
    ports:
      - "8081:443"
    networks:
      - microb-network
    environment:
      ASPNETCORE_ENVIRONMENT: Development
      ASPNETCORE_URLS: "https://+:443;http://+80"
      ASPNETCORE_HTTP_PORTS: 80
      ASPNETCORE_HTTPS_PORTS: 443
      ASPNETCORE_Kestrel__Certificates__Default__Password: Qwertyuiop1!
      ASPNETCORE_Kestrel__Certificates__Default__Path: /https/Microb.ApiGateway.pfx
    volumes:
      - ../https:/https:z

  microb-keycloak-server:
    container_name: microb-keycloak-server
    image: keycloak/keycloak:latest
    env_file:
      - keycloak.env
    ports:
      - "8090:8080"
    networks:
      - microb-network
    command: start-dev
    volumes:
      - type: bind
        source: ../volumes/keycloak/data
        target: /opt/keycloak/data/

networks:
  microb-network:
    name: microb-network
    driver: bridge
